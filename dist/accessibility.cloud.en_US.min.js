(function(b,c){'object'==typeof exports&&'object'==typeof module?module.exports=c():'function'==typeof define&&define.amd?define([],c):'object'==typeof exports?exports['accessibility.cloud']=c():b['accessibility.cloud']=c()})(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var f=c[d]={i:d,l:!1,exports:{}};return a[d].call(f.exports,f,f.exports,b),f.l=!0,f.exports}var c={};return b.m=a,b.c=c,b.i=function(d){return d},b.d=function(d,f,g){b.o(d,f)||Object.defineProperty(d,f,{configurable:!1,enumerable:!0,get:g})},b.n=function(d){var f=d&&d.__esModule?function(){return d['default']}:function(){return d};return b.d(f,'a',f),f},b.o=function(d,f){return Object.prototype.hasOwnProperty.call(d,f)},b.p='',b(b.s=5)}([function(a,b,c){'use strict';function d(u,v){const w=v[`${u}Localized`]||u;return o()(w).replace(/^Rating /,'')}function f(u){return!0===u?'Yes':!1===u?'No':u}function g(u){const v=Math.floor(5*Math.min(1,Math.max(0,u))),w='\u2605\u2605\u2605\u2605\u2605'.slice(5-v);return`<span class="stars">${w}</span> <span class="numeric">${v}/5</span>`}function h(u){if($.isArray(u))return`<ul class="ac-list">${u.map(v=>`<li>${h(v)}</li>`).join('')}</ul>`;if($.isPlainObject(u)){const v=$.map(u,(w,x)=>{if(x.match(/Localized/))return'';const y=d(x,u);return $.isArray(w)||$.isPlainObject(w)?'areas'===x&&1===w.length?h(w[0]):`<li class="ac-group"><header class='subtle'>${y}</header> ${h(w)}</li>`:x.startsWith('rating')?`<li class="ac-rating">${y}: ${g(parseFloat(w))}</li>`:`<li class="ac-${typeof w}">${y}: <span class='value'>${f(w)}</span></li>`});return`<ul class="ac-group">${v.join('')}</ul>`}return u}function k(u){return u.accessibility&&u.accessibility.accessibleWith&&u.accessibility.accessibleWith.wheelchair}var l=c(4),m=c.n(l),n=c(3),o=c.n(n),p=c(1);c.n(p),Object.defineProperty(b,'__esModule',{value:!0});const q={apiDomain:'https://www.accessibility.cloud',getPlacesAround(u){return $.ajax({dataType:'json',url:`${this.apiDomain}/place-infos?includeRelated=source&locale=${'en_US'}`,data:u,headers:{Accept:'application/json','X-Token':this.token}})},resultsTemplate(){return`<ul class="ac-result-list" role="treegrid"> \
      {{#places}} \
        {{#properties}} \
          <li class="ac-result {{isAccessibleClass}}" role="gridcell" aria-expanded="false"> \
            <div class="ac-summary"> \
              <img src="${this.apiDomain}/icons/categories/{{category}}.svg"
                role="presentation"
                class="ac-result-icon"> \
              <header class="ac-result-name" role="heading">{{name}}</header> \
              <div class="ac-result-distance">{{formattedDistance}}</div> \
              <div class="ac-result-category">{{humanizedCategory}}</div> \
              {{#infoPageUrl}}<a href="{{infoPageUrl}}" class="ac-result-link">{{sourceName}}</a>{{/infoPageUrl}} \
              <div class="ac-result-accessibility-summary">{{accessibilitySummary}}</div> \
              <div class="ac-result-accessibility-details ac-hidden">{{{formattedAccessibility}}}</div> \
            </div> \
          </li> \
        {{/properties}} \
      {{/places}} \
    </ul>`},renderPlaces(u,v,w){$(u).length&&(v&&v.length?($(u).html(m.a.render(this.resultsTemplate(),{places:v,humanizedCategory(){return o()(this.localizedCategory||this.category)},formattedDistance(){return`${Math.round(this.distance)}m`},formattedAccessibility(){return h(this.accessibility)},isAccessibleClass(){return k(this)?'is-accessible':''},accessibilitySummary(){return k(this)?'Accessible with wheelchair':'Not accessible with wheelchair'},sourceName(){const x=w.sources&&w.sources[this.sourceId];return x&&(x.shortName||x.name)}})),$('li.ac-result a').click(x=>x.stopPropagation()),$('li.ac-result').click(x=>$(x.target).parent().find('.ac-result-accessibility-details').first().slideToggle())):$(u).html(`<div class="ac-no-results">${'No results.'}</div>`))},renderSourcesAndLicenses(u,v,w){const x=Object.keys(v).map(y=>{const z=v[y],A=w[z.licenseId],B=`${this.apiDomain}/browse/licenses/${A._id}`,C=z.originWebsiteURL||`${this.apiDomain}/browse/sources/${z._id}`;return`<a href="${C}">${z.shortName||z.name}</a>
        (<a href="${B}">${A.shortName||A.name}</a>)`});x.length&&$(u).append(`<p class="ac-licenses">${'Source'}: ${x.join(', ')}</p>`)},loadAndRenderPlaces(u,v){return this.getPlacesAround(v).done(w=>{this.renderPlaces(u,w.features,w.related),this.renderSourcesAndLicenses(u,w.related.sources,w.related.licenses)}).fail(w=>{let x='Unknown error.';if(w)try{x=JSON.parse(w.responseText).error.reason}catch(y){x=`${w.statusText}<br>${w.responseText}`}$(u).html(`<div class="ac-error">${'Could not load data'}:${x}</div>`)})}};b['default']=q},function(a,b){'use strict';'use strict';Object.defineProperty(b,'__esModule',{value:!0}),b.t=function(d){for(var f=arguments.length,g=Array(1<f?f-1:0),h=1;h<f;h++)g[h-1]=arguments[h];return d&&d.reduce?d.reduce(function(k,l,m){return k+l+(g[m]||'')},''):d},b.nt=function(){return function(d){for(var f=arguments.length,g=Array(1<f?f-1:0),h=1;h<f;h++)g[h-1]=arguments[h];return d&&d.reduce?d.reduce(function(k,l,m){return k+l+(g[m]||'')},''):d}},b.msgid=function(d){for(var f=arguments.length,g=Array(1<f?f-1:0),h=1;h<f;h++)g[h-1]=arguments[h];return d&&d.reduce?d.reduce(function(k,l,m){return k+l+(g[m]||'')},''):d},b.gettext=function(d){return d},b.ngettext=function(d){return d}},function(a){'use strict';'use strict';a.exports=function(b,c){if('string'!=typeof b)throw new TypeError('Expected a string');return c='undefined'==typeof c?'_':c,b.replace(/([a-z\d])([A-Z])/g,'$1'+c+'$2').replace(/([A-Z]+)([A-Z][a-z\d]+)/g,'$1'+c+'$2').toLowerCase()}},function(a,b,c){'use strict';'use strict';var d=c(2);a.exports=function(f){if('string'!=typeof f)throw new TypeError('Expected a string');return f=d(f),f=f.toLowerCase().replace(/[_-]+/g,' ').replace(/\s{2,}/g,' ').trim(),f=f.charAt(0).toUpperCase()+f.slice(1),f}},function(a,b){var c,d,f;(function(h,k){'object'==typeof b&&b&&'string'!=typeof b.nodeName?k(b):(d=[b],c=k,f='function'==typeof c?c.apply(b,d):c,!(f!==void 0&&(a.exports=f)))})(this,function(h){function k(K){return'function'==typeof K}function l(K){return A(K)?'array':typeof K}function m(K){return K.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,'\\$&')}function n(K,L){return null!=K&&'object'==typeof K&&L in K}function o(K,L){return B.call(K,L)}function p(K){return!o(C,K)}function q(K,L){function M(){if(R&&!S)for(;Q.length;)delete P[Q.pop()];else Q=[];R=!1,S=!1}function N(ea){if('string'==typeof ea&&(ea=ea.split(F,2)),!A(ea)||2!==ea.length)throw new Error('Invalid tags: '+ea);T=new RegExp(m(ea[0])+'\\s*'),U=new RegExp('\\s*'+m(ea[1])),V=new RegExp('\\s*'+m('}'+ea[1]))}if(!K)return[];var T,U,V,O=[],P=[],Q=[],R=!1,S=!1;N(L||h.tags);for(var X,Y,Z,_,aa,ba,W=new w(K);!W.eos();){if(X=W.pos,Z=W.scanUntil(T),Z)for(var ca=0,da=Z.length;ca<da;++ca)_=Z.charAt(ca),p(_)?Q.push(P.length):S=!0,P.push(['text',_,X,X+1]),X+=1,'\n'===_&&M();if(!W.scan(T))break;if(R=!0,Y=W.scan(I)||'name',W.scan(E),'='===Y?(Z=W.scanUntil(G),W.scan(G),W.scanUntil(U)):'{'===Y?(Z=W.scanUntil(V),W.scan(H),W.scanUntil(U),Y='&'):Z=W.scanUntil(U),!W.scan(U))throw new Error('Unclosed tag at '+W.pos);if(aa=[Y,Z,X,W.pos],P.push(aa),'#'===Y||'^'===Y)O.push(aa);else if('/'===Y){if(ba=O.pop(),!ba)throw new Error('Unopened section "'+Z+'" at '+X);if(ba[1]!==Z)throw new Error('Unclosed section "'+ba[1]+'" at '+X)}else'name'===Y||'{'===Y||'&'===Y?S=!0:'='===Y&&N(Z)}if(ba=O.pop(),ba)throw new Error('Unclosed section "'+ba[1]+'" at '+W.pos);return v(u(P))}function u(K){var M,N,L=[];for(var O=0,P=K.length;O<P;++O)M=K[O],M&&('text'===M[0]&&N&&'text'===N[0]?(N[1]+=M[1],N[3]=M[3]):(L.push(M),N=M));return L}function v(K){var O,P,L=[],M=L,N=[];for(var Q=0,R=K.length;Q<R;++Q)switch(O=K[Q],O[0]){case'#':case'^':M.push(O),N.push(O),M=O[4]=[];break;case'/':P=N.pop(),P[5]=O[2],M=0<N.length?N[N.length-1][4]:L;break;default:M.push(O);}return L}function w(K){this.string=K,this.tail=K,this.pos=0}function x(K,L){this.view=K,this.cache={'.':this.view},this.parent=L}function y(){this.cache={}}var z=Object.prototype.toString,A=Array.isArray||function(L){return'[object Array]'===z.call(L)},B=RegExp.prototype.test,C=/\S/,D={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;','/':'&#x2F;','`':'&#x60;','=':'&#x3D;'},E=/\s*/,F=/\s+/,G=/\s*=/,H=/\s*\}/,I=/#|\^|\/|>|\{|&|=|!/;w.prototype.eos=function(){return''===this.tail},w.prototype.scan=function(L){var M=this.tail.match(L);if(!M||0!==M.index)return'';var N=M[0];return this.tail=this.tail.substring(N.length),this.pos+=N.length,N},w.prototype.scanUntil=function(L){var N,M=this.tail.search(L);return-1===M?(N=this.tail,this.tail=''):0===M?N='':(N=this.tail.substring(0,M),this.tail=this.tail.substring(M)),this.pos+=N.length,N},x.prototype.push=function(L){return new x(L,this)},x.prototype.lookup=function(L){var N,M=this.cache;if(M.hasOwnProperty(L))N=M[L];else{for(var P,Q,O=this,R=!1;O;){if(0<L.indexOf('.'))for(N=O.view,P=L.split('.'),Q=0;null!=N&&Q<P.length;)Q===P.length-1&&(R=n(N,P[Q])),N=N[P[Q++]];else N=O.view[L],R=n(O.view,L);if(R)break;O=O.parent}M[L]=N}return k(N)&&(N=N.call(this.view)),N},y.prototype.clearCache=function(){this.cache={}},y.prototype.parse=function(L,M){var N=this.cache,O=N[L];return null==O&&(O=N[L]=q(L,M)),O},y.prototype.render=function(L,M,N){var O=this.parse(L),P=M instanceof x?M:new x(M);return this.renderTokens(O,P,N,L)},y.prototype.renderTokens=function(L,M,N,O){var Q,R,S,P='';for(var T=0,U=L.length;T<U;++T)S=void 0,Q=L[T],R=Q[0],'#'===R?S=this.renderSection(Q,M,N,O):'^'===R?S=this.renderInverted(Q,M,N,O):'>'===R?S=this.renderPartial(Q,M,N,O):'&'===R?S=this.unescapedValue(Q,M):'name'===R?S=this.escapedValue(Q,M):'text'==R&&(S=this.rawValue(Q)),void 0!=S&&(P+=S);return P},y.prototype.renderSection=function(L,M,N,O){function P(V){return Q.render(V,M,N)}var Q=this,R='',S=M.lookup(L[1]);if(S){if(A(S))for(var T=0,U=S.length;T<U;++T)R+=this.renderTokens(L[4],M.push(S[T]),N,O);else if('object'==typeof S||'string'==typeof S||'number'==typeof S)R+=this.renderTokens(L[4],M.push(S),N,O);else if(k(S)){if('string'!=typeof O)throw new Error('Cannot use higher-order sections without the original template');S=S.call(M.view,O.slice(L[3],L[5]),P),null!=S&&(R+=S)}else R+=this.renderTokens(L[4],M,N,O);return R}},y.prototype.renderInverted=function(L,M,N,O){var P=M.lookup(L[1]);if(!P||A(P)&&0===P.length)return this.renderTokens(L[4],M,N,O)},y.prototype.renderPartial=function(L,M,N){if(N){var O=k(N)?N(L[1]):N[L[1]];if(null!=O)return this.renderTokens(this.parse(O),M,N,O)}},y.prototype.unescapedValue=function(L,M){var N=M.lookup(L[1]);if(null!=N)return N},y.prototype.escapedValue=function(L,M){var N=M.lookup(L[1]);if(null!=N)return h.escape(N)},y.prototype.rawValue=function(L){return L[1]},h.name='mustache.js',h.version='2.3.0',h.tags=['{{','}}'];var J=new y;return h.clearCache=function(){return J.clearCache()},h.parse=function(L,M){return J.parse(L,M)},h.render=function(L,M,N){if('string'!=typeof L)throw new TypeError('Invalid template! Template should be a "string" but "'+l(L)+'" was given as the first argument for mustache#render(template, view, partials)');return J.render(L,M,N)},h.to_html=function(L,M,N,O){var P=h.render(L,M,N);return k(O)?void O(P):P},h.escape=function(L){return(L+'').replace(/[&<>"'`=\/]/g,function(N){return D[N]})},h.Scanner=w,h.Context=x,h.Writer=y,h})},function(a,b,c){a.exports=c(0)}])});