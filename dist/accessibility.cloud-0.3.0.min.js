(function(b,c){'object'==typeof exports&&'object'==typeof module?module.exports=c():'function'==typeof define&&define.amd?define([],c):'object'==typeof exports?exports['accessibility.cloud']=c():b['accessibility.cloud']=c()})(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var f=c[d]={i:d,l:!1,exports:{}};return a[d].call(f.exports,f,f.exports,b),f.l=!0,f.exports}var c={};return b.m=a,b.c=c,b.i=function(d){return d},b.d=function(d,f,g){b.o(d,f)||Object.defineProperty(d,f,{configurable:!1,enumerable:!0,get:g})},b.n=function(d){var f=d&&d.__esModule?function(){return d['default']}:function(){return d};return b.d(f,'a',f),f},b.o=function(d,f){return Object.prototype.hasOwnProperty.call(d,f)},b.p='',b(b.s=4)}([function(a,b,c){'use strict';function d(q){return q.replace(/([A-Z])/g,' $1').replace(/^./,r=>r.toUpperCase()).replace(/^Rating /,'')}function f(q){return!0===q?'Yes':!1===q?'No':q}function g(q){const r=Math.floor(5*Math.min(1,Math.max(0,q))),t='\u2605\u2605\u2605\u2605\u2605'.slice(5-r);return`<span class="stars">${t}</span> <span class="numeric">${r}/5</span>`}function h(q){if($.isArray(q))return`<ul class="ac-list">${q.map(r=>`<li>${h(r)}</li>`).join('')}</ul>`;if($.isPlainObject(q)){const r=$.map(q,(t,u)=>{return $.isArray(t)||$.isPlainObject(t)?'areas'===u&&1===t.length?h(t[0]):`<li class="ac-group"><span class='subtle'>${d(u)}</span> ${h(t)}</li>`:u.startsWith('rating')?`<li class="ac-rating">${d(u)}: ${g(parseFloat(t))}</li>`:`<li>${d(u)}: ${f(t)}</li>`});return`<ul class="ac-group">${r.join('')}</ul>`}return q}function k(q){return q.accessibility&&q.accessibility.accessibleWith&&q.accessibility.accessibleWith.wheelchair}var l=c(3),m=c.n(l),n=c(2),o=c.n(n);Object.defineProperty(b,'__esModule',{value:!0});const p={apiDomain:'https://www.accessibility.cloud',getPlacesAround(q){return $.ajax({dataType:'json',url:`${this.apiDomain}/place-infos?includeRelated=source`,data:q,headers:{Accept:'application/json','X-Token':this.token}})},resultsTemplate(){return`<ul class="ac-result-list" role="treegrid"> \
      {{#places}} \
        {{#properties}} \
          <li class="ac-result {{isAccessibleClass}}" role="gridcell" aria-expanded="false"> \
            <div class="ac-summary"> \
              <img src="${this.apiDomain}/icons/categories/{{category}}@2x.png"
                srcset="${this.apiDomain}/icons/categories/{{category}}@4x.png 2x"
                role="presentation"
                class="ac-result-icon"> \
              <header class="ac-result-name" role="heading">{{name}}</header> \
              <div class="ac-result-distance">{{formattedDistance}}</div> \
              <div class="ac-result-category">{{humanizedCategory}}</div> \
              <a href="{{infoPageUrl}}" class="ac-result-link">{{sourceName}}</a> \
              <div class="ac-result-accessibility-summary">{{accessibilitySummary}}</div> \
              <div class="ac-result-accessibility-details ac-hidden">{{{formattedAccessibility}}}</div> \
            </div> \
          </li> \
        {{/properties}} \
      {{/places}} \
    </ul>`},renderPlaces(q,r,t){$(q).length&&(r&&r.length?($(q).html(m.a.render(this.resultsTemplate(),{places:r,humanizedCategory(){return o()(this.category)},formattedDistance(){return`${Math.round(this.distance)}m`},formattedAccessibility(){return h(this.accessibility)},isAccessibleClass(){return k(this)?'is-accessible':''},accessibilitySummary(){return k(this)?'Accessible with wheelchair':'Not accessible with wheelchair'},sourceName(){const u=t.sources&&t.sources[this.sourceId];return u&&(u.shortName||u.name)}})),$('li.ac-result a').click(u=>u.stopPropagation()),$('li.ac-result').click(u=>$(u.target).parent().find('.ac-result-accessibility-details').first().slideToggle())):$(q).html('<div class="ac-no-results">No results.</div>'))},renderSourcesAndLicenses(q,r,t){const u=Object.keys(r).map(v=>{const w=r[v],x=t[w.licenseId],y=`${this.apiDomain}/browse/licenses/${x._id}`,z=w.originWebsiteURL||`${this.apiDomain}/browse/sources/${w._id}`;return`<a href="${z}">${w.shortName||w.name}</a>
        (<a href="${y}">${x.shortName||x.name}</a>)`});u.length&&$(q).append(`<p class="ac-licenses">Data: ${u.join(', ')}</p>`)},loadAndRenderPlaces(q,r){return this.getPlacesAround(r).done(t=>{this.renderPlaces(q,t.features,t.related),this.renderSourcesAndLicenses(q,t.related.sources,t.related.licenses)}).fail(t=>{let u='No error message';if(t)try{u=JSON.parse(t.responseText).error.reason}catch(v){u=`${t.statusText}<br>${t.responseText}`}$(q).html(`<div class="ac-error">Could not load data:${u}</div>`)})}};b['default']=p},function(a){'use strict';'use strict';a.exports=function(b,c){if('string'!=typeof b)throw new TypeError('Expected a string');return c='undefined'==typeof c?'_':c,b.replace(/([a-z\d])([A-Z])/g,'$1'+c+'$2').replace(/([A-Z]+)([A-Z][a-z\d]+)/g,'$1'+c+'$2').toLowerCase()}},function(a,b,c){'use strict';'use strict';var d=c(1);a.exports=function(f){if('string'!=typeof f)throw new TypeError('Expected a string');return f=d(f),f=f.toLowerCase().replace(/[_-]+/g,' ').replace(/\s{2,}/g,' ').trim(),f=f.charAt(0).toUpperCase()+f.slice(1),f}},function(a,b){var c,d,f;(function(h,k){'object'==typeof b&&b&&'string'!=typeof b.nodeName?k(b):(d=[b],c=k,f='function'==typeof c?c.apply(b,d):c,!(f!==void 0&&(a.exports=f)))})(this,function(h){function k(I){return'function'==typeof I}function l(I){return y(I)?'array':typeof I}function m(I){return I.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,'\\$&')}function n(I,J){return null!=I&&'object'==typeof I&&J in I}function o(I,J){return z.call(I,J)}function p(I){return!o(A,I)}function q(I,J){function K(){if(P&&!Q)for(;O.length;)delete N[O.pop()];else O=[];P=!1,Q=!1}function L(ca){if('string'==typeof ca&&(ca=ca.split(D,2)),!y(ca)||2!==ca.length)throw new Error('Invalid tags: '+ca);R=new RegExp(m(ca[0])+'\\s*'),S=new RegExp('\\s*'+m(ca[1])),T=new RegExp('\\s*'+m('}'+ca[1]))}if(!I)return[];var R,S,T,M=[],N=[],O=[],P=!1,Q=!1;L(J||h.tags);for(var V,W,X,Y,Z,_,U=new u(I);!U.eos();){if(V=U.pos,X=U.scanUntil(R),X)for(var aa=0,ba=X.length;aa<ba;++aa)Y=X.charAt(aa),p(Y)?O.push(N.length):Q=!0,N.push(['text',Y,V,V+1]),V+=1,'\n'===Y&&K();if(!U.scan(R))break;if(P=!0,W=U.scan(G)||'name',U.scan(C),'='===W?(X=U.scanUntil(E),U.scan(E),U.scanUntil(S)):'{'===W?(X=U.scanUntil(T),U.scan(F),U.scanUntil(S),W='&'):X=U.scanUntil(S),!U.scan(S))throw new Error('Unclosed tag at '+U.pos);if(Z=[W,X,V,U.pos],N.push(Z),'#'===W||'^'===W)M.push(Z);else if('/'===W){if(_=M.pop(),!_)throw new Error('Unopened section "'+X+'" at '+V);if(_[1]!==X)throw new Error('Unclosed section "'+_[1]+'" at '+V)}else'name'===W||'{'===W||'&'===W?Q=!0:'='===W&&L(X)}if(_=M.pop(),_)throw new Error('Unclosed section "'+_[1]+'" at '+U.pos);return t(r(N))}function r(I){var K,L,J=[];for(var M=0,N=I.length;M<N;++M)K=I[M],K&&('text'===K[0]&&L&&'text'===L[0]?(L[1]+=K[1],L[3]=K[3]):(J.push(K),L=K));return J}function t(I){var M,N,J=[],K=J,L=[];for(var O=0,P=I.length;O<P;++O)switch(M=I[O],M[0]){case'#':case'^':K.push(M),L.push(M),K=M[4]=[];break;case'/':N=L.pop(),N[5]=M[2],K=0<L.length?L[L.length-1][4]:J;break;default:K.push(M);}return J}function u(I){this.string=I,this.tail=I,this.pos=0}function v(I,J){this.view=I,this.cache={'.':this.view},this.parent=J}function w(){this.cache={}}var x=Object.prototype.toString,y=Array.isArray||function(J){return'[object Array]'===x.call(J)},z=RegExp.prototype.test,A=/\S/,B={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;','/':'&#x2F;','`':'&#x60;','=':'&#x3D;'},C=/\s*/,D=/\s+/,E=/\s*=/,F=/\s*\}/,G=/#|\^|\/|>|\{|&|=|!/;u.prototype.eos=function(){return''===this.tail},u.prototype.scan=function(J){var K=this.tail.match(J);if(!K||0!==K.index)return'';var L=K[0];return this.tail=this.tail.substring(L.length),this.pos+=L.length,L},u.prototype.scanUntil=function(J){var L,K=this.tail.search(J);return-1===K?(L=this.tail,this.tail=''):0===K?L='':(L=this.tail.substring(0,K),this.tail=this.tail.substring(K)),this.pos+=L.length,L},v.prototype.push=function(J){return new v(J,this)},v.prototype.lookup=function(J){var L,K=this.cache;if(K.hasOwnProperty(J))L=K[J];else{for(var N,O,M=this,P=!1;M;){if(0<J.indexOf('.'))for(L=M.view,N=J.split('.'),O=0;null!=L&&O<N.length;)O===N.length-1&&(P=n(L,N[O])),L=L[N[O++]];else L=M.view[J],P=n(M.view,J);if(P)break;M=M.parent}K[J]=L}return k(L)&&(L=L.call(this.view)),L},w.prototype.clearCache=function(){this.cache={}},w.prototype.parse=function(J,K){var L=this.cache,M=L[J];return null==M&&(M=L[J]=q(J,K)),M},w.prototype.render=function(J,K,L){var M=this.parse(J),N=K instanceof v?K:new v(K);return this.renderTokens(M,N,L,J)},w.prototype.renderTokens=function(J,K,L,M){var O,P,Q,N='';for(var R=0,S=J.length;R<S;++R)Q=void 0,O=J[R],P=O[0],'#'===P?Q=this.renderSection(O,K,L,M):'^'===P?Q=this.renderInverted(O,K,L,M):'>'===P?Q=this.renderPartial(O,K,L,M):'&'===P?Q=this.unescapedValue(O,K):'name'===P?Q=this.escapedValue(O,K):'text'==P&&(Q=this.rawValue(O)),void 0!=Q&&(N+=Q);return N},w.prototype.renderSection=function(J,K,L,M){function N(T){return O.render(T,K,L)}var O=this,P='',Q=K.lookup(J[1]);if(Q){if(y(Q))for(var R=0,S=Q.length;R<S;++R)P+=this.renderTokens(J[4],K.push(Q[R]),L,M);else if('object'==typeof Q||'string'==typeof Q||'number'==typeof Q)P+=this.renderTokens(J[4],K.push(Q),L,M);else if(k(Q)){if('string'!=typeof M)throw new Error('Cannot use higher-order sections without the original template');Q=Q.call(K.view,M.slice(J[3],J[5]),N),null!=Q&&(P+=Q)}else P+=this.renderTokens(J[4],K,L,M);return P}},w.prototype.renderInverted=function(J,K,L,M){var N=K.lookup(J[1]);if(!N||y(N)&&0===N.length)return this.renderTokens(J[4],K,L,M)},w.prototype.renderPartial=function(J,K,L){if(L){var M=k(L)?L(J[1]):L[J[1]];if(null!=M)return this.renderTokens(this.parse(M),K,L,M)}},w.prototype.unescapedValue=function(J,K){var L=K.lookup(J[1]);if(null!=L)return L},w.prototype.escapedValue=function(J,K){var L=K.lookup(J[1]);if(null!=L)return h.escape(L)},w.prototype.rawValue=function(J){return J[1]},h.name='mustache.js',h.version='2.3.0',h.tags=['{{','}}'];var H=new w;return h.clearCache=function(){return H.clearCache()},h.parse=function(J,K){return H.parse(J,K)},h.render=function(J,K,L){if('string'!=typeof J)throw new TypeError('Invalid template! Template should be a "string" but "'+l(J)+'" was given as the first argument for mustache#render(template, view, partials)');return H.render(J,K,L)},h.to_html=function(J,K,L,M){var N=h.render(J,K,L);return k(M)?void M(N):N},h.escape=function(J){return(J+'').replace(/[&<>"'`=\/]/g,function(L){return B[L]})},h.Scanner=u,h.Context=v,h.Writer=w,h})},function(a,b,c){a.exports=c(0)}])});